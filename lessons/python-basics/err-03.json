{
  "id": "err-03",
  "title": "Handling Multiple Exceptions",
  "category": "Error Handling",
  "number": 83,
  "duration": "6 min read",
  "content": "## Handling Multiple Exceptions\n\nReal-world code often needs to handle different types of errors differently. Python provides several ways to handle multiple exceptions.\n\n## Multiple Except Blocks\n\nHandle each exception type separately:\n\n```python\ntry:\n    value = int(input(\"Enter a number: \"))\n    result = 100 / value\n    data = [1, 2, 3][value]\nexcept ValueError:\n    print(\"Invalid number format\")\nexcept ZeroDivisionError:\n    print(\"Cannot divide by zero\")\nexcept IndexError:\n    print(\"Index out of range\")\n```\n\n## Catching Multiple Exceptions Together\n\nUse a tuple to catch multiple exceptions with the same handler:\n\n```python\ntry:\n    # Some risky operation\n    result = process_data(data)\nexcept (ValueError, TypeError, KeyError):\n    print(\"Data processing error\")\n```\n\n### With Exception Capture\n\n```python\ntry:\n    result = risky_operation()\nexcept (ValueError, TypeError) as e:\n    print(f\"Error occurred: {type(e).__name__}: {e}\")\n```\n\n## Combining Approaches\n\n```python\ndef process_user_data(data):\n    try:\n        user_id = int(data['id'])\n        name = data['name'].strip()\n        age = int(data['age'])\n        return {'id': user_id, 'name': name, 'age': age}\n    except KeyError as e:\n        print(f\"Missing required field: {e}\")\n    except ValueError as e:\n        print(f\"Invalid value: {e}\")\n    except (TypeError, AttributeError) as e:\n        print(f\"Invalid data format: {e}\")\n    return None\n```\n\n## Exception Hierarchy Matters\n\nCatch more specific exceptions first:\n\n```python\n# CORRECT - specific exceptions first\ntry:\n    file = open(\"data.txt\")\nexcept FileNotFoundError:\n    print(\"File not found\")\nexcept PermissionError:\n    print(\"Permission denied\")\nexcept OSError:\n    print(\"OS error occurred\")\n\n# WRONG - parent class catches all\ntry:\n    file = open(\"data.txt\")\nexcept OSError:  # This catches FileNotFoundError too!\n    print(\"OS error\")\nexcept FileNotFoundError:  # Never reached!\n    print(\"File not found\")\n```\n\n## The Else Clause\n\nThe `else` block runs only if no exception occurred:\n\n```python\ntry:\n    number = int(input(\"Enter a number: \"))\nexcept ValueError:\n    print(\"Invalid input!\")\nelse:\n    print(f\"You entered: {number}\")\n    print(f\"Squared: {number ** 2}\")\n```\n\n### Why Use Else?\n\n- Keeps successful code separate from error handling\n- Makes it clear what code is \"protected\"\n- Avoids catching exceptions from code that shouldn't be protected\n\n```python\ntry:\n    file = open(\"data.txt\")\nexcept FileNotFoundError:\n    print(\"File not found\")\nelse:\n    # This code runs only if open() succeeded\n    content = file.read()  # If this fails, it's a different error\n    file.close()\n    process(content)\n```\n\n## Practical Examples\n\n### Configuration Parser\n\n```python\nimport json\n\ndef load_config(filename):\n    try:\n        with open(filename, 'r') as f:\n            config = json.load(f)\n    except FileNotFoundError:\n        print(f\"Config file '{filename}' not found, using defaults\")\n        return {}\n    except json.JSONDecodeError as e:\n        print(f\"Invalid JSON in config: {e}\")\n        return {}\n    except PermissionError:\n        print(f\"Cannot read '{filename}': permission denied\")\n        return {}\n    else:\n        print(f\"Config loaded successfully\")\n        return config\n```\n\n### Database-Style Operations\n\n```python\ndef update_record(records, record_id, field, value):\n    try:\n        record = records[record_id]\n        old_value = record[field]\n        record[field] = value\n    except KeyError as e:\n        if record_id not in records:\n            return f\"Record {record_id} not found\"\n        return f\"Field '{field}' not found\"\n    except TypeError:\n        return \"Invalid record format\"\n    else:\n        return f\"Updated {field}: {old_value} -> {value}\"\n```\n\n### API Response Handler\n\n```python\ndef handle_api_response(response):\n    try:\n        data = response.json()\n        result = data['result']\n        items = result['items']\n    except json.JSONDecodeError:\n        return \"Invalid JSON response\"\n    except KeyError as e:\n        return f\"Missing expected field: {e}\"\n    except TypeError:\n        return \"Unexpected response structure\"\n    else:\n        return items\n```\n\n## Order of Clauses\n\n```python\ntry:\n    # Risky code\n    pass\nexcept SpecificError:\n    # Handle specific error\n    pass\nexcept GeneralError:\n    # Handle general error\n    pass\nelse:\n    # Runs if no exception\n    pass\nfinally:\n    # Always runs (covered in next lesson)\n    pass\n```",
  "code": "# Handling Multiple Exceptions\n\n# Example 1: Multiple except blocks\nprint(\"=== Multiple Except Blocks ===\")\n\ndef process_input(value):\n    try:\n        number = int(value)\n        result = 100 / number\n        return f\"Result: {result}\"\n    except ValueError:\n        return \"Error: Not a valid number\"\n    except ZeroDivisionError:\n        return \"Error: Cannot divide by zero\"\n\nprint(process_input(\"5\"))    # Works\nprint(process_input(\"abc\"))  # ValueError\nprint(process_input(\"0\"))    # ZeroDivisionError\n\n# Example 2: Catching multiple exceptions together\nprint(\"\\n=== Grouped Exceptions ===\")\n\ndef get_item_safe(data, key):\n    try:\n        return data[key]\n    except (KeyError, IndexError, TypeError) as e:\n        return f\"Access error ({type(e).__name__}): {e}\"\n\nprint(get_item_safe({\"a\": 1}, \"b\"))  # KeyError\nprint(get_item_safe([1, 2], 10))      # IndexError\nprint(get_item_safe(None, \"x\"))       # TypeError\n\n# Example 3: Using else clause\nprint(\"\\n=== Else Clause ===\")\n\ndef divide_numbers(a, b):\n    try:\n        result = a / b\n    except ZeroDivisionError:\n        print(\"Cannot divide by zero!\")\n        return None\n    except TypeError:\n        print(\"Both arguments must be numbers!\")\n        return None\n    else:\n        # Only runs if no exception occurred\n        print(f\"Division successful: {a} / {b}\")\n        return result\n\nprint(f\"Result: {divide_numbers(10, 2)}\")\nprint(f\"Result: {divide_numbers(10, 0)}\")\n\n# Example 4: Real-world scenario\nprint(\"\\n=== User Data Processor ===\")\n\ndef process_user(data):\n    try:\n        name = data['name'].strip().title()\n        age = int(data['age'])\n        email = data['email'].lower()\n    except KeyError as e:\n        return f\"Missing field: {e}\"\n    except ValueError:\n        return \"Age must be a number\"\n    except AttributeError:\n        return \"Invalid data types\"\n    else:\n        return {'name': name, 'age': age, 'email': email}\n\n# Test cases\nprint(process_user({'name': 'alice', 'age': '25', 'email': 'ALICE@EXAMPLE.COM'}))\nprint(process_user({'name': 'bob', 'email': 'bob@example.com'}))  # Missing age\nprint(process_user({'name': 'charlie', 'age': 'thirty', 'email': 'c@test.com'}))"
}
