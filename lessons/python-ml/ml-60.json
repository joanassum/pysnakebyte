{
  "id": "ml-60",
  "title": "Model Selection",
  "category": "Scikit-Learn",
  "number": 60,
  "duration": "12 min read",
  "content": "## Choosing the Best Model\n\nModel selection involves comparing different algorithms and their hyperparameters to find the best solution for your problem.\n\n### Comparison Strategy\n\n1.  **Define Metric**: Choose a metric that aligns with business goals (Accuracy, F1, RMSE, etc.).\n2.  **Establish Baseline**: What is the performance of a dummy model or simple heuristic?\n3.  **Spot Check Algorithms**: Quickly train multiple standard algorithms using cross-validation.\n4.  **Select Top Performers**: Pick the top 2-3 algorithms for tuning.\n5.  **Tune and Finalize**: Optimize hyperparameters and select the winner.\n",
  "code": "import matplotlib.pyplot as plt\nfrom sklearn import model_selection\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.discriminant_analysis import LinearDiscriminantAnalysis\nfrom sklearn.naive_bayes import GaussianNB\nfrom sklearn.svm import SVC\nfrom sklearn.datasets import load_iris\n\n# Prepare Data\nX, y = load_iris(return_X_y=True)\n\n# Prepare Models\nmodels = []\nmodels.append(('LR', LogisticRegression(max_iter=1000)))\nmodels.append(('LDA', LinearDiscriminantAnalysis()))\nmodels.append(('KNN', KNeighborsClassifier()))\nmodels.append(('CART', DecisionTreeClassifier()))\nmodels.append(('NB', GaussianNB()))\nmodels.append(('SVM', SVC()))\n\n# Evaluate each model in turn\nresults = []\nnames = []\nscoring = 'accuracy'\n\nprint(\"Model Comparison:\")\nfor name, model in models:\n    kfold = model_selection.KFold(n_splits=10, shuffle=True, random_state=42)\n    cv_results = model_selection.cross_val_score(model, X, y, cv=kfold, scoring=scoring)\n    results.append(cv_results)\n    names.append(name)\n    print(f\"{name}: {cv_results.mean():.4f} ({cv_results.std():.4f})\")\n\n# Boxplot comparison\nplt.boxplot(results, labels=names)\nplt.title('Algorithm Comparison')\nplt.show()"
}
