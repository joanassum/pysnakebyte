{
  "id": "ml-89",
  "title": "Association Rules",
  "category": "Unsupervised Learning",
  "number": 89,
  "duration": "10 min read",
  "content": "## Association Rules\n\nAssociation rule learning is a rule-based machine learning method for discovering interesting relations between variables in large databases. It is often used for Market Basket Analysis.\n\n### Concepts\n\n*   **Support**: How frequently the itemset appears in the dataset. $Support(A) = Transactions(A) / Total Transactions$.\n*   **Confidence**: How often the rule has been found to be true. $Confidence(A \\to B) = Support(A \\cup B) / Support(A)$.\n*   **Lift**: The ratio of the observed support to that expected if X and Y were independent. $Lift(A \\to B) = Support(A \\cup B) / (Support(A) * Support(B))$.\n    *   Lift > 1: Positive correlation.\n    *   Lift < 1: Negative correlation.\n    *   Lift = 1: Independent.\n\n### Apriori Algorithm\n\nA popular algorithm used to identify frequent itemsets and derive association rules.\n\n```python\n# Requires `mlxtend` library: pip install mlxtend\nfrom mlxtend.frequent_patterns import apriori, association_rules\n\n# Find frequent itemsets\nfrequent_itemsets = apriori(df, min_support=0.05, use_colnames=True)\n\n# Generate rules\nrules = association_rules(frequent_itemsets, metric=\"lift\", min_threshold=1)\n```\n",
  "code": "import pandas as pd\nfrom mlxtend.preprocessing import TransactionEncoder\nfrom mlxtend.frequent_patterns import apriori, association_rules\n\n# Sample dataset\ndataset = [['Milk', 'Onion', 'Nutmeg', 'Kidney Beans', 'Eggs', 'Yogurt'],\n           ['Dill', 'Onion', 'Nutmeg', 'Kidney Beans', 'Eggs', 'Yogurt'],\n           ['Milk', 'Apple', 'Kidney Beans', 'Eggs'],\n           ['Milk', 'Unicorn', 'Corn', 'Kidney Beans', 'Yogurt'],\n           ['Corn', 'Onion', 'Onion', 'Kidney Beans', 'Ice cream', 'Eggs']]\n\nte = TransactionEncoder()\nte_ary = te.fit(dataset).transform(dataset)\ndf = pd.DataFrame(te_ary, columns=te.columns_)\n\n# TODO: Find frequent itemsets with min_support=0.6\n# frequent_itemsets = \n\n# TODO: Generate association rules with metric=\"confidence\" and min_threshold=0.7\n# rules = \n# print(rules[['antecedents', 'consequents', 'support', 'confidence']])"
}